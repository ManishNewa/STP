!function(a){"function"==typeof define&&define.amd?define(["jquery"],function(b){a(b,window,document)}):a(jQuery,window,document)}(function(a,b,c,d){"use strict";function e(b,c){this.element=b,this.options=a.extend({},h,c),this._defaults=h,this.ns="."+f+g++,this.isGoodBrowser=Boolean(b.setSelectionRange),this._name=f,this.init()}var f="intlTelInput",g=1,h={autoFormat:!0,autoHideDialCode:!0,defaultCountry:"",nationalMode:!1,onlyCountries:[],preferredCountries:["us","gb"],responsiveDropdown:!1,validationScript:""},i={UP:38,DOWN:40,ENTER:13,ESC:27,PLUS:43,A:65,Z:90,ZERO:48,NINE:57,SPACE:32,BSPACE:8,DEL:46,CTRL:17,CMD1:91,CMD2:224},j=!1;a(b).load(function(){j=!0}),e.prototype={init:function(){this.options.nationalMode&&(this.options.autoFormat=this.options.autoHideDialCode=!1),navigator.userAgent.match(/Android/i)&&navigator.userAgent.match(/Chrome/i)&&(this.options.autoFormat=!1),this._processCountryData(),this._generateMarkup(),this._setInitialState(),this._initListeners()},_processCountryData:function(){this._setInstanceCountryData(),this._setPreferredCountries()},_setInstanceCountryData:function(){var b=this;if(this.options.onlyCountries.length){var c,d,e=[],f={};for(d=0;d<this.options.onlyCountries.length;d++){var g=this.options.onlyCountries[d],h=b._getCountryData(g,!0,!1);h&&(e.push(h),c=h.dialCode,f[c]?f[c].push(g):f[c]=[g])}for(c in f)if(f[c].length>1){var i=[];for(d=0;d<l[c].length;d++){var j=l[c][d];a.inArray(f[c],j)&&i.push(j)}f[c]=i}this.countries=e,this.countryCodes=f}else this.countries=k,this.countryCodes=l},_setPreferredCountries:function(){var a=this;this.preferredCountries=[];for(var b=0;b<this.options.preferredCountries.length;b++){var c=this.options.preferredCountries[b],d=a._getCountryData(c,!1,!0);d&&a.preferredCountries.push(d)}},_generateMarkup:function(){this.telInput=a(this.element),this.telInput.wrap(a("<div>",{class:"intl-tel-input"}));var b=a("<div>",{class:"flag-dropdown"}).insertAfter(this.telInput),c=a("<div>",{class:"selected-flag"}).appendTo(b);this.selectedFlagInner=a("<div>",{class:"flag"}).appendTo(c),a("<div>",{class:"arrow"}).appendTo(this.selectedFlagInner),this.countryList=a("<ul>",{class:"country-list v-hide"}).appendTo(b),this.preferredCountries.length&&(this._appendListItems(this.preferredCountries,"preferred"),a("<li>",{class:"divider"}).appendTo(this.countryList)),this._appendListItems(this.countries,""),this.dropdownHeight=this.countryList.outerHeight(),this.countryList.removeClass("v-hide").addClass("hide"),this.options.responsiveDropdown&&this.countryList.outerWidth(this.telInput.outerWidth()),this.countryListItems=this.countryList.children(".country")},_appendListItems:function(a,b){for(var c="",d=0;d<a.length;d++){var e=a[d];c+="<li class='country "+b+"' data-dial-code='"+e.dialCode+"' data-country-code='"+e.iso2+"'>",c+="<div class='flag "+e.iso2+"'></div>",c+="<span class='country-name'>"+e.name+"</span>",c+="<span class='dial-code'>+"+e.dialCode+"</span>",c+="</li>"}this.countryList.append(c)},_setInitialState:function(){var a=this.telInput.val();if(!a||!this.setNumber(a)){var b;b=this.options.defaultCountry?this._getCountryData(this.options.defaultCountry,!1,!1):this.preferredCountries.length?this.preferredCountries[0]:this.countries[0],this._selectFlag(b.iso2),this.options.autoHideDialCode||this._resetToDialCode(b.dialCode)}},_initListeners:function(){var d=this;this.options.autoHideDialCode&&this._initAutoHideDialCode();var e=this.telInput.closest("label");e.length&&e.on("click"+this.ns,function(a){d.countryList.hasClass("hide")?d.telInput.focus():a.preventDefault()}),this.options.autoFormat&&(this.telInput.on("keydown"+this.ns,function(a){a.which!=i.BSPACE&&a.which!=i.DEL||"+"!=d.telInput.val()||a.preventDefault()}),this.telInput.on("keypress"+this.ns,function(a){if(a.which>=i.SPACE){a.preventDefault();var b=a.which>=i.ZERO&&a.which<=i.NINE,c=d.telInput[0],e=d.isGoodBrowser&&c.selectionStart==c.selectionEnd;if(b||e){var f=b?String.fromCharCode(a.which):null;d._handleInputKey(f,!1)}}})),this.telInput.on("keyup"+this.ns,function(a){if(d.options.autoFormat){var b=a.which==i.CTRL||a.which==i.CMD1||a.which==i.CMD2,c=d.telInput[0],e=d.isGoodBrowser&&c.selectionStart==c.selectionEnd,f=d.isGoodBrowser&&c.selectionStart==d.telInput.val().length;if(a.which==i.DEL||a.which==i.BSPACE||b&&e){var g=a.which==i.BSPACE&&f;d._handleInputKey(null,g)}d.telInput.val()||d.telInput.val("+")}else d._updateFlag()});var f=this.selectedFlagInner.parent();if(f.on("click"+this.ns,function(){d.countryList.hasClass("hide")&&!d.telInput.prop("disabled")&&d._showDropdown()}),this.options.validationScript){var g=function(){var a=c.createElement("script");a.type="text/javascript",a.src=d.options.validationScript,c.body.appendChild(a)};j?g():a(b).load(g)}},_handleInputKey:function(a,b){var c=this.telInput.val(),d=null,e=!1,f=this.telInput[0];if(this.isGoodBrowser){var g=f.selectionEnd,h=c.length;e=g==h,a?(c=c.substring(0,f.selectionStart)+a+c.substring(g,h),e||(d=g+(c.length-h))):d=f.selectionStart}else a&&(c+=a);this.setNumber(c,b),this.isGoodBrowser&&(e&&(d=this.telInput.val().length),f.setSelectionRange(d,d))},_initAutoHideDialCode:function(){var b=this;this.telInput.on("mousedown"+this.ns,function(a){b.telInput.is(":focus")||b.telInput.val()||(a.preventDefault(),b._focus())}),this.telInput.on("focus"+this.ns,function(){a.trim(b.telInput.val())||(b._updateVal("+"+b.selectedCountryData.dialCode,!0),b.telInput.one("keypress.plus"+b.ns,function(a){a.which==i.PLUS&&b.telInput.val("+")}))}),this.telInput.on("blur"+this.ns,function(){var a=b.telInput.val(),c="+"==a.substring(0,1);if(c){var d=a.replace(/\D/g,"");d&&b._getDialCode().replace(/\D/g,"")!=d||b.telInput.val("")}b.telInput.off("keypress.plus"+b.ns)})},_focus:function(){this.telInput.focus();var a=this.telInput[0];if(this.isGoodBrowser){var b=this.telInput.val().length;a.setSelectionRange(b,b)}},_showDropdown:function(){this._setDropdownPosition();var a=this.countryList.children(".active");this._highlightListItem(a),this.countryList.removeClass("hide"),this._scrollTo(a),this._bindDropdownListeners(),this.selectedFlagInner.children(".arrow").addClass("up")},_setDropdownPosition:function(){var c=this.telInput.offset().top,d=a(b).scrollTop(),e=c+this.telInput.outerHeight()+this.dropdownHeight<d+a(b).height(),f=c-this.dropdownHeight>d,g=!e&&f?"-"+(this.dropdownHeight-1)+"px":"";this.countryList.css("top",g)},_bindDropdownListeners:function(){var b=this;this.countryList.on("mouseover"+this.ns,".country",function(){b._highlightListItem(a(this))}),this.countryList.on("click"+this.ns,".country",function(){b._selectListItem(a(this))});var d=!0;a("html").on("click"+this.ns,function(){d||b._closeDropdown(),d=!1});var e="",f=null;a(c).on("keydown"+this.ns,function(a){a.preventDefault(),a.which==i.UP||a.which==i.DOWN?b._handleUpDownKey(a.which):a.which==i.ENTER?b._handleEnterKey():a.which==i.ESC?b._closeDropdown():(a.which>=i.A&&a.which<=i.Z||a.which==i.SPACE)&&(f&&clearTimeout(f),e+=String.fromCharCode(a.which),b._searchForCountry(e),f=setTimeout(function(){e=""},1e3))})},_handleUpDownKey:function(a){var b=this.countryList.children(".highlight").first(),c=a==i.UP?b.prev():b.next();c.length&&(c.hasClass("divider")&&(c=a==i.UP?c.prev():c.next()),this._highlightListItem(c),this._scrollTo(c))},_handleEnterKey:function(){var a=this.countryList.children(".highlight").first();a.length&&this._selectListItem(a)},_searchForCountry:function(a){for(var b=0;b<this.countries.length;b++)if(this._startsWith(this.countries[b].name,a)){var c=this.countryList.children("[data-country-code="+this.countries[b].iso2+"]").not(".preferred");this._highlightListItem(c),this._scrollTo(c,!0);break}},_startsWith:function(a,b){return a.substr(0,b.length).toUpperCase()==b},_updateVal:function(a,b,c){var d,e="";if(this.options.autoFormat){if(d=a.replace(/\D/g,""),b){var f=this.selectedCountryData.format;if(f)for(var g=0;g<f.length;g++)if("."==f[g]){if(!d)break;if(e+=d.substring(0,1),d=d.substring(1),!d&&c)break}else e+=f[g]}e||"+"!=a.substring(0,1)||(e="+")}else d=a;this.telInput.val(e+d)},_updateFlag:function(a){var b=this._getDialCode(a);if(b){for(var c=this.countryCodes[b.replace(/\D/g,"")],d=!1,e=0;e<c.length;e++)this.selectedFlagInner.hasClass(c[e])&&(d=!0);d||this._selectFlag(c[0])}return b},_resetToDialCode:function(a){var b=this.options.nationalMode?"":"+"+a;this.telInput.val(b)},_highlightListItem:function(a){this.countryListItems.removeClass("highlight"),a.addClass("highlight")},_getCountryData:function(a,b,c){for(var d=b?k:this.countries,e=0;e<d.length;e++)if(d[e].iso2==a)return d[e];if(c)return null;throw new Error("No country data for '"+a+"'")},_selectFlag:function(a){this.selectedFlagInner.attr("class","flag "+a),this.selectedCountryData=this._getCountryData(a,!1,!1);var b=this.selectedCountryData.name+": +"+this.selectedCountryData.dialCode;this.selectedFlagInner.parent().attr("title",b);var c=this.countryListItems.children(".flag."+a).first().parent();this.countryListItems.removeClass("active"),c.addClass("active")},_selectListItem:function(a){var b=a.attr("data-country-code");this._selectFlag(b),this._closeDropdown(),this.options.nationalMode||(this._updateDialCode("+"+a.attr("data-dial-code")),this.telInput.trigger("change")),this._focus()},_closeDropdown:function(){this.countryList.addClass("hide"),this.selectedFlagInner.children(".arrow").removeClass("up"),a(c).off(this.ns),a("html").off(this.ns),this.countryList.off(this.ns)},_scrollTo:function(a,b){var c=this.countryList,d=c.height(),e=c.offset().top,f=e+d,g=a.outerHeight(),h=a.offset().top,i=h+g,j=h-e+c.scrollTop(),k=d/2-g/2;if(e>h)b&&(j-=k),c.scrollTop(j);else if(i>f){b&&(j+=k);var l=d-g;c.scrollTop(j-l)}},_updateDialCode:function(b){var c,d=this.telInput.val(),e=this._getDialCode();if(e.length>1)c=d.replace(e,b);else{var f=d&&"+"!=d.substr(0,1)?a.trim(d):"";c=b+f}this._updateVal(c,!0)},_getDialCode:function(b){var c="",d=b||this.telInput.val();if("+"==d.charAt(0))for(var e="",f=0;f<d.length;f++){var g=d.charAt(f);if(a.isNumeric(g)&&(e+=g,this.countryCodes[e]&&(c=d.substring(0,f+1)),4==e.length))break}return c},destroy:function(){this._closeDropdown(),this.telInput.off(this.ns),this.selectedFlagInner.parent().off(this.ns),this.telInput.closest("label").off(this.ns);var a=this.telInput.parent();a.before(this.telInput).remove()},getSelectedCountryData:function(){return this.selectedCountryData},isValidNumber:function(c){var d=a.trim(this.telInput.val()),e=c?this.selectedCountryData.iso2:"",f=/[a-zA-Z]/.test(d);return!f&&b.isValidNumber(d,e)},selectCountry:function(a){this.selectedFlagInner.hasClass(a)||(this._selectFlag(a),this.telInput.val()||this.options.autoHideDialCode||this._resetToDialCode(this.selectedCountryData.dialCode))},setNumber:function(a,b){var c=this._updateFlag(a);return this._updateVal(a,c,b),c}},a.fn[f]=function(b){var c=arguments;if(b===d||"object"==typeof b)return this.each(function(){a.data(this,"plugin_"+f)||a.data(this,"plugin_"+f,new e(this,b))});if("string"==typeof b&&"_"!==b[0]&&"init"!==b){var g;return this.each(function(){var d=a.data(this,"plugin_"+f);d instanceof e&&"function"==typeof d[b]&&(g=d[b].apply(d,Array.prototype.slice.call(c,1))),"destroy"===b&&a.data(this,"plugin_"+f,null)}),g!==d?g:this}},a.fn[f].getCountryData=function(){return k},a.fn[f].setCountryData=function(a){k=a};for(var k=[["Afghanistan (‫افغانستان‬‎)","af","93"],["Albania (Shqipëri)","al","355"],["Algeria (‫الجزائر‬‎)","dz","213"],["American Samoa","as","1684"],["Andorra","ad","376"],["Angola","ao","244"],["Anguilla","ai","1264"],["Antigua and Barbuda","ag","1268"],["Argentina","ar","54"],["Armenia (Հայաստան)","am","374"],["Aruba","aw","297"],["Australia","au","61","+.. ... ... ..."],["Austria (Österreich)","at","43"],["Azerbaijan (Azərbaycan)","az","994"],["Bahamas","bs","1242"],["Bahrain (‫البحرين‬‎)","bh","973"],["Bangladesh (বাংলাদেশ)","bd","880"],["Barbados","bb","1246"],["Belarus (Беларусь)","by","375"],["Belgium (België)","be","32","+.. ... .. .. .."],["Belize","bz","501"],["Benin (Bénin)","bj","229"],["Bermuda","bm","1441"],["Bhutan (འབྲུག)","bt","975"],["Bolivia","bo","591"],["Bosnia and Herzegovina (Босна и Херцеговина)","ba","387"],["Botswana","bw","267"],["Brazil (Brasil)","br","55"],["British Indian Ocean Territory","io","246"],["British Virgin Islands","vg","1284"],["Brunei","bn","673"],["Bulgaria (България)","bg","359"],["Burkina Faso","bf","226"],["Burundi (Uburundi)","bi","257"],["Cambodia (កម្ពុជា)","kh","855"],["Cameroon (Cameroun)","cm","237"],["Canada","ca","1","+. (...) ...-....",1],["Cape Verde (Kabu Verdi)","cv","238"],["Caribbean Netherlands","bq","599","",1],["Cayman Islands","ky","1345"],["Central African Republic (République centrafricaine)","cf","236"],["Chad (Tchad)","td","235"],["Chile","cl","56"],["China (中国)","cn","86","+.. ..-........"],["Colombia","co","57"],["Comoros (‫جزر القمر‬‎)","km","269"],["Congo (DRC) (Jamhuri ya Kidemokrasia ya Kongo)","cd","243"],["Congo (Republic) (Congo-Brazzaville)","cg","242"],["Cook Islands","ck","682"],["Costa Rica","cr","506","+... ....-...."],["Côte d’Ivoire","ci","225"],["Croatia (Hrvatska)","hr","385"],["Cuba","cu","53"],["Curaçao","cw","599","",0],["Cyprus (Κύπρος)","cy","357"],["Czech Republic (Česká republika)","cz","420"],["Denmark (Danmark)","dk","45","+.. .. .. .. .."],["Djibouti","dj","253"],["Dominica","dm","1767"],["Dominican Republic (República Dominicana)","do","1809"],["Ecuador","ec","593"],["Egypt (‫مصر‬‎)","eg","20"],["El Salvador","sv","503","+... ....-...."],["Equatorial Guinea (Guinea Ecuatorial)","gq","240"],["Eritrea","er","291"],["Estonia (Eesti)","ee","372"],["Ethiopia","et","251"],["Falkland Islands (Islas Malvinas)","fk","500"],["Faroe Islands (Føroyar)","fo","298"],["Fiji","fj","679"],["Finland (Suomi)","fi","358","+... .. ... .. .."],["France","fr","33","+.. . .. .. .. .."],["French Guiana (Guyane française)","gf","594"],["French Polynesia (Polynésie française)","pf","689"],["Gabon","ga","241"],["Gambia","gm","220"],["Georgia (საქართველო)","ge","995"],["Germany (Deutschland)","de","49","+.. ... ......."],["Ghana (Gaana)","gh","233"],["Gibraltar","gi","350"],["Greece (Ελλάδα)","gr","30"],["Greenland (Kalaallit Nunaat)","gl","299"],["Grenada","gd","1473"],["Guadeloupe","gp","590","",0],["Guam","gu","1671"],["Guatemala","gt","502","+... ....-...."],["Guinea (Guinée)","gn","224"],["Guinea-Bissau (Guiné Bissau)","gw","245"],["Guyana","gy","592"],["Haiti","ht","509","+... ....-...."],["Honduras","hn","504"],["Hong Kong (香港)","hk","852","+... .... ...."],["Hungary (Magyarország)","hu","36"],["Iceland (Ísland)","is","354","+... ... ...."],["India (भारत)","in","91","+.. .....-....."],["Indonesia","id","62"],["Iran (‫ایران‬‎)","ir","98"],["Iraq (‫العراق‬‎)","iq","964"],["Ireland","ie","353","+... .. ......."],["Israel (‫ישראל‬‎)","il","972"],["Italy (Italia)","it","39","+.. ... ......"],["Jamaica","jm","1876"],["Japan (日本)","jp","81","+.. ... .. ...."],["Jordan (‫الأردن‬‎)","jo","962"],["Kazakhstan (Казахстан)","kz","7","+. ... ...-..-..",1],["Kenya","ke","254"],["Kiribati","ki","686"],["Kuwait (‫الكويت‬‎)","kw","965"],["Kyrgyzstan (Кыргызстан)","kg","996"],["Laos (ລາວ)","la","856"],["Latvia (Latvija)","lv","371"],["Lebanon (‫لبنان‬‎)","lb","961"],["Lesotho","ls","266"],["Liberia","lr","231"],["Libya (‫ليبيا‬‎)","ly","218"],["Liechtenstein","li","423"],["Lithuania (Lietuva)","lt","370"],["Luxembourg","lu","352"],["Macau (澳門)","mo","853"],["Macedonia (FYROM) (Македонија)","mk","389"],["Madagascar (Madagasikara)","mg","261"],["Malawi","mw","265"],["Malaysia","my","60","+.. ..-....-...."],["Maldives","mv","960"],["Mali","ml","223"],["Malta","mt","356"],["Marshall Islands","mh","692"],["Martinique","mq","596"],["Mauritania (‫موريتانيا‬‎)","mr","222"],["Mauritius (Moris)","mu","230"],["Mexico (México)","mx","52"],["Micronesia","fm","691"],["Moldova (Republica Moldova)","md","373"],["Monaco","mc","377"],["Mongolia (Монгол)","mn","976"],["Montenegro (Crna Gora)","me","382"],["Montserrat","ms","1664"],["Morocco (‫المغرب‬‎)","ma","212"],["Mozambique (Moçambique)","mz","258"],["Myanmar (Burma) (မြန်မာ)","mm","95"],["Namibia (Namibië)","na","264"],["Nauru","nr","674"],["Nepal (नेपाल)","np","977"],["Netherlands (Nederland)","nl","31","+.. .. ........"],["New Caledonia (Nouvelle-Calédonie)","nc","687"],["New Zealand","nz","64","+.. ...-...-...."],["Nicaragua","ni","505"],["Niger (Nijar)","ne","227"],["Nigeria","ng","234"],["Niue","nu","683"],["Norfolk Island","nf","672"],["North Korea (조선 민주주의 인민 공화국)","kp","850"],["Northern Mariana Islands","mp","1670"],["Norway (Norge)","no","47","+.. ... .. ..."],["Oman (‫عُمان‬‎)","om","968"],["Pakistan (‫پاکستان‬‎)","pk","92","+.. ...-......."],["Palau","pw","680"],["Palestine (‫فلسطين‬‎)","ps","970"],["Panama (Panamá)","pa","507"],["Papua New Guinea","pg","675"],["Paraguay","py","595"],["Peru (Perú)","pe","51"],["Philippines","ph","63","+.. ... ...."],["Poland (Polska)","pl","48","+.. ...-...-..."],["Portugal","pt","351"],["Puerto Rico","pr","1787"],["Qatar (‫قطر‬‎)","qa","974"],["Réunion (La Réunion)","re","262"],["Romania (România)","ro","40"],["Russia (Россия)","ru","7","+. ... ...-..-..",0],["Rwanda","rw","250"],["Saint Barthélemy (Saint-Barthélemy)","bl","590","",1],["Saint Helena","sh","290"],["Saint Kitts and Nevis","kn","1869"],["Saint Lucia","lc","1758"],["Saint Martin (Saint-Martin (partie française))","mf","590","",2],["Saint Pierre and Miquelon (Saint-Pierre-et-Miquelon)","pm","508"],["Saint Vincent and the Grenadines","vc","1784"],["Samoa","ws","685"],["San Marino","sm","378"],["São Tomé and Príncipe (São Tomé e Príncipe)","st","239"],["Saudi Arabia (‫المملكة العربية السعودية‬‎)","sa","966"],["Senegal (Sénégal)","sn","221"],["Serbia (Србија)","rs","381"],["Seychelles","sc","248"],["Sierra Leone","sl","232"],["Singapore","sg","65","+.. ....-...."],["Sint Maarten","sx","1721"],["Slovakia (Slovensko)","sk","421"],["Slovenia (Slovenija)","si","386"],["Solomon Islands","sb","677"],["Somalia (Soomaaliya)","so","252"],["South Africa","za","27"],["South Korea (대한민국)","kr","82"],["South Sudan (‫جنوب السودان‬‎)","ss","211"],["Spain (España)","es","34","+.. ... ... ..."],["Sri Lanka (ශ්‍රී ලංකාව)","lk","94"],["Sudan (‫السودان‬‎)","sd","249"],["Suriname","sr","597"],["Swaziland","sz","268"],["Sweden (Sverige)","se","46"],["Switzerland (Schweiz)","ch","41","+.. .. ... .. .."],["Syria (‫سوريا‬‎)","sy","963"],["Taiwan (台灣)","tw","886"],["Tajikistan","tj","992"],["Tanzania","tz","255"],["Thailand (ไทย)","th","66"],["Timor-Leste","tl","670"],["Togo","tg","228"],["Tokelau","tk","690"],["Tonga","to","676"],["Trinidad and Tobago","tt","1868"],["Tunisia (‫تونس‬‎)","tn","216"],["Turkey (Türkiye)","tr","90","+.. ... ... .. .."],["Turkmenistan","tm","993"],["Turks and Caicos Islands","tc","1649"],["Tuvalu","tv","688"],["U.S. Virgin Islands","vi","1340"],["Uganda","ug","256"],["Ukraine (Україна)","ua","380"],["United Arab Emirates (‫الإمارات العربية المتحدة‬‎)","ae","971"],["United Kingdom","gb","44","+.. .... ......"],["United States","us","1","+. (...) ...-....",0],["Uruguay","uy","598"],["Uzbekistan (Oʻzbekiston)","uz","998"],["Vanuatu","vu","678"],["Vatican City (Città del Vaticano)","va","379"],["Venezuela","ve","58"],["Vietnam (Việt Nam)","vn","84"],["Wallis and Futuna","wf","681"],["Yemen (‫اليمن‬‎)","ye","967"],["Zambia","zm","260"],["Zimbabwe","zw","263"]],l={},m=0;m<k.length;m++){var n=k[m];k[m]={name:n[0],iso2:n[1],dialCode:n[2]},n[3]&&(k[m].format=n[3]),n[2]in l||(l[n[2]]=[]);var o=n[4]||0;l[n[2]][o]=n[1]}});
(function(){var $,__indexOf=[].indexOf||function(item){for(var i=0,l=this.length;i<l;i++){if(i in this&&this[i]===item)return i}return-1};$=jQuery;$.fn.validateCreditCard=function(callback,options){var card,card_type,card_types,get_card_type,is_valid_length,is_valid_luhn,normalize,validate,validate_number,_i,_len,_ref,_ref1;card_types=[{name:"amex",pattern:/^3[47]/,valid_length:[15]},{name:"diners_club_carte_blanche",pattern:/^30[0-5]/,valid_length:[14]},{name:"diners_club_international",pattern:/^36/,valid_length:[14]},{name:"jcb",pattern:/^35(2[89]|[3-8][0-9])/,valid_length:[16]},{name:"laser",pattern:/^(6304|670[69]|6771)/,valid_length:[16,17,18,19]},{name:"visa_electron",pattern:/^(4026|417500|4508|4844|491(3|7))/,valid_length:[16]},{name:"visa",pattern:/^4/,valid_length:[16]},{name:"mastercard",pattern:/^5[1-5]/,valid_length:[16]},{name:"maestro",pattern:/^(5018|5020|5038|6304|6759|676[1-3])/,valid_length:[12,13,14,15,16,17,18,19]},{name:"discover",pattern:/^(6011|622(12[6-9]|1[3-9][0-9]|[2-8][0-9]{2}|9[0-1][0-9]|92[0-5]|64[4-9])|65)/,valid_length:[16]}];if(options==null){options={}}if((_ref=options.accept)==null){options.accept=function(){var _i,_len,_results;_results=[];for(_i=0,_len=card_types.length;_i<_len;_i++){card=card_types[_i];_results.push(card.name)}return _results}()}_ref1=options.accept;for(_i=0,_len=_ref1.length;_i<_len;_i++){card_type=_ref1[_i];if(__indexOf.call(function(){var _j,_len1,_results;_results=[];for(_j=0,_len1=card_types.length;_j<_len1;_j++){card=card_types[_j];_results.push(card.name)}return _results}(),card_type)<0){throw"Credit card type '"+card_type+"' is not supported"}}get_card_type=function(number){var _j,_len1,_ref2;_ref2=function(){var _k,_len1,_ref2,_results;_results=[];for(_k=0,_len1=card_types.length;_k<_len1;_k++){card=card_types[_k];if(_ref2=card.name,__indexOf.call(options.accept,_ref2)>=0){_results.push(card)}}return _results}();for(_j=0,_len1=_ref2.length;_j<_len1;_j++){card_type=_ref2[_j];if(number.match(card_type.pattern)){return card_type}}return null};is_valid_luhn=function(number){var digit,n,sum,_j,_len1,_ref2;sum=0;_ref2=number.split("").reverse();for(n=_j=0,_len1=_ref2.length;_j<_len1;n=++_j){digit=_ref2[n];digit=+digit;if(n%2){digit*=2;if(digit<10){sum+=digit}else{sum+=digit-9}}else{sum+=digit}}return sum%10===0};is_valid_length=function(number,card_type){var _ref2;return _ref2=number.length,__indexOf.call(card_type.valid_length,_ref2)>=0};validate_number=function(number){var length_valid,luhn_valid;card_type=get_card_type(number);luhn_valid=false;length_valid=false;if(card_type!=null){luhn_valid=is_valid_luhn(number);length_valid=is_valid_length(number,card_type)}return callback({card_type:card_type,luhn_valid:luhn_valid,length_valid:length_valid})};validate=function(){var number;number=normalize($(this).val());return validate_number(number)};normalize=function(number){return number.replace(/[ -]/g,"")};this.bind("input",function(){$(this).unbind("keyup");return validate.call(this)});this.bind("keyup",function(){return validate.call(this)});if(this.length!==0){validate.call(this)}return this}}).call(this);
jQuery(document).ready(function($){"use strict";var ajaxRequests=[];$.fn.instantHelp=function instantHelp(options){function InstantHelp(options){if(options===undefined){options={}}this.step=options.step!==undefined?options.step:1;this.subjectId=options.subjectId!==undefined?options.subjectId:-1;this.subjectText=options.subjectText!==undefined?options.subjectText:"";this.container=$("#instant-help").length?$("#instant-help"):undefined;this.cb=options.cb!==undefined?options.cb:undefined;this.form="";this.description=options.description!==undefined?options.description:"";this.startDate=0;this.startTime=0;this.duration=0;this.gradeLevelText="";this.gradeLevelId=0;this.sessionType="";this.PAYASGOID=32;this.couponValid=null;this.spcValid=null;this.userType="student"}InstantHelp.prototype={showInstantHelp:function(){var self=this;if(this.container===undefined){noty({timeout:4e3,text:["Instant help overlay not found."],type:"error",layout:"topCenter"});return false}this.container.addClass("open");$("body").css({overflow:"hidden",height:"100%"});this.container.find('[data-type="subject"]').selectize();this.container.find('[data-type="grade"]').selectize();setTimeout(function(){switch(self.step){case 1:self.showInstantHelpStep_1();break;case 2:self.showInstantHelpStep_2();break;case 3:self.showInstantHelpStep_3();break;default:}},200);this.container.find("#close-instant-help").on("click",function(){self.container.animateCss("fadeOutUp",function(){resetInstantHelp(self.container)})});if($("#chat-container").length){var $chatContainer=$("#chat-container");$chatContainer.find(".chat-minimize").trigger("click")}$.ajaxSetup({beforeSend:function(req){ajaxRequests.push(req)}})},showInstantHelpStep_1:function(){var self=this;self.container.find("#instant-help-step-1").animateCss("fadeInDown");self.container.find("#instant-help-step-1").show();self.form=self.container.find('form[name="instant-help-step-1"]');var formData=new FormData;var $subjectsSelect=self.form.find('[data-type="subject"]');if($subjectsSelect.hasClass("selectized")){$subjectsSelect.get(0).selectize.destroy()}$subjectsSelect.selectize({preload:false,maxItems:1,valueField:"id",labelField:"name",searchField:["name"],sortField:"name",placeholder:"Subject",selectOnTab:true,create:false,onInitialize:function(){if(self.subjectId!==""&&self.subjectText!==""&&!$.fn.isFromAshford()){$subjectsSelect.get(0).selectize.addOption({id:self.subjectId,name:self.subjectText});$subjectsSelect.get(0).selectize.addItem(self.subjectId)}},onItemAdd:function(value,$item){this.close();this.blur();setTimeout(function(){self.form.find('[data-type="subject"] option:selected').text($item.text());self.subjectText=$item.text();self.subjectId=value},100)},load:function(query,callback){if(query.length<3||$.fn.isFromAshford())return callback();$.ajax({url:Routing.generate("skooli_get_all_subjects",{query:query},true),type:"GET",error:function(){callback()},success:function(res){callback(res)}})}});var $gradeLevelSelect=self.form.find('[data-type="grade"]');$.ajax({url:Routing.generate("skooli.get_grade_level"),method:"GET",success:function(data){if($gradeLevelSelect.hasClass("selectized")){$gradeLevelSelect.get(0).selectize.destroy()}self.form.find('[data-type="grade"]').html("");self.form.find('[data-type="grade"]').append(data);self.form.find('[data-type="grade"]').selectize({selectOnTab:true,delimiter:",",persist:false,onInitialize:function(){if($.fn.isFromAshford()){self.form.find('[data-type="grade"]').get(0).selectize.setValue(22);var AshfordGrades=[21,22,23,24];$.each(self.form.find('[data-type="grade"]').parent().find(".option"),function(index,value){if($.inArray($(this).data("value"),AshfordGrades)===-1){self.form.find('[data-type="grade"]').get(0).selectize.removeOption($(this).data("value"))}});self.form.find('[data-type="grade"]').get(0).selectize.refreshOptions(false)}},onItemAdd:function(value,$item){this.close();this.blur();setTimeout(function(){self.form.find('[data-type="grade"] option:selected').text($item.text());self.gradeLevelText=$item.text();self.gradeLevelId=value},100)}})}});if(self.description!==""){self.form.find('[name="description"]').val(self.description)}self.form.find("p.show-file-dropzone").off().on("click",function(){$(this).fadeOut("fast");self.form.find("#instant-help-dropzone").fadeIn("200",function(){$(this).addClass("dropzone");var dropzoneOptions={url:self.form.attr("action"),method:"POST",paramName:"session_file",maxFilesize:6,maxFiles:1,parallelUploads:1,addRemoveLinks:true,acceptedFiles:"application/pdf,application/x-pdf,image/jpeg,image/gif,image/png,image/tiff,image/x-tiff,"+"image/bmp,image/x-windows-bmp,application/msword,application/vnd.openxmlformats-officedocument.wordprocessingml.document,"+"text/plain,application/rtf,application/x-rtf,text/richtext,application/vnd.oasis.opendocument.text",autoProcessQueue:false,dictDefaultMessage:"Drag & Drop or <i>Browse for files</i>",init:function(){var drop=this;drop.on("addedfile",function(file){if(!file.type.match(/image.*/)){myDropzone.emit("thumbnail",file,"/bundles/skooliuser/images/fileimg.png")}setTimeout(function(){if(file.accepted===true){formData.append("session_file",file)}},100)});drop.on("maxfilesexceeded",function(file){drop.removeFile(file)});drop.on("removedfile",function(){formData.delete("session_file")})}};var myDropzone=new Dropzone("#instant-help-dropzone",dropzoneOptions)})});moment.locale("en-ca",{calendar:{sameDay:"[Today]",nextDay:"[Tomorrow]",nextWeek:"ddd, MMM DD",lastDay:"[Yesterday]",lastWeek:"[Last] dddd",sameElse:"ddd, MMM DD"}});var $sessionTypes=self.form.find(".instant-help-custom-radio-btn");$sessionTypes.find(".radio").on("click",function(){$sessionTypes.find("input:checked").prop("checked",false);$(this).find("input").prop("checked",true);$(this).find("input").trigger("change")});$sessionTypes.find("input").on("change",function(){if($(this).val()==="1"){var $preffDate=self.form.find('[name="preferred-date"]');var $preffTimes=self.form.find('[name="preferred-time"]');var $preffDuration=self.form.find('[name="preferred-duration"]');self.form.find(".custom-instant-help").fadeIn("slow",function(){if(self.form.find(".custom-instant-help select").hasClass("selectized")){return false}var dates=createSessionDates();$preffDate.selectize({preload:false,maxItems:1,valueField:"id",labelField:"name",searchField:["name"],sortField:"id",placeholder:"Date",selectOnTab:true,options:dates,create:false,closeAfterSelect:true,onInitialize:function(){this.setValue(dates[0].id)},onChange:function(value){self.startDate=value;if($preffTimes.hasClass("selectized")){var times=createTimesForDay(value);$preffTimes.get(0).selectize.clearOptions();$preffTimes.get(0).selectize.renderCache={};$preffTimes.get(0).selectize.addOption(times);$preffTimes.get(0).selectize.refreshOptions(false);$preffTimes.get(0).selectize.setValue("07:00")}this.close();this.blur()}});var times=createTimesForDay(moment().format("YYYY-MM-DD"));$preffTimes.selectize({preload:false,maxItems:1,valueField:"id",labelField:"name",searchField:["name"],sortField:"id",placeholder:"Time",selectOnTab:true,options:times.length?times:[],create:false,closeAfterSelect:true,onInitialize:function(){if(times.length){this.setValue(times[0].id)}},onChange:function(value){self.startTime=value;this.close();this.blur()},onItemAdd:function(value,$item){this.close();this.blur()}});var durations=createDurations();$preffDuration.selectize({preload:false,maxItems:1,valueField:"id",labelField:"name",searchField:["name"],sortField:"id",placeholder:"Time",selectOnTab:true,options:durations,create:false,closeAfterSelect:true,onInitialize:function(){this.setValue(45)},onChange:function(value){self.duration=parseInt(value);this.close();this.blur()},onItemAdd:function(value,$item){this.close();this.blur()}})});self.sessionType="custom"}else{self.form.find(".custom-instant-help").fadeOut();self.sessionType=""}});self.form.find(".submit_form").off().on("click",function(){self.form.submit()});self.form.validate({ignore:":hidden:not([class~=selectized]),:hidden > .selectized, .selectize-control .selectize-input input",focusInvalid:false,onfocusout:function(element){if($(element).valid()){if($(element).parent().hasClass("selectize-input")){$(element).parent().parent().next("label.error").remove()}}},errorPlacement:function(error,element){return true},invalidHandler:function(e,validator){var invalidElements=[];for(var i=0;i<validator.errorList.length;i++){var element=$("#"+validator.errorList[i].element.id).parent().find("label").text();var elementMsg=validator.errorList[i].message;if($.inArray(element+": "+elementMsg,invalidElements)===-1){invalidElements.push(element+": "+elementMsg)}}self.form.sklValidationResults({status:"error",errorMessages:invalidElements,persistMessages:false,shouldSlideContainer:false,persistenceTimeout:5e3})},highlight:function(element,errorClass){if($(element).hasClass("selectized")){$(element).siblings(".selectize-control").find(".selectize-input").addClass("isnotvalid")}else{$(element).addClass("isnotvalid")}},unhighlight:function(element,errorClass){$(element).removeClass("isnotvalid");$(element).parent().removeClass("isnotvalid")},rules:{description:{required:true},grade:{required:true},subject:{required:true},"preferred-date":{required:true},"preferred-time":{required:true},"preferred-duration":{required:true}}});self.form.off("submit").on("submit",function(e){e.preventDefault();if(self.form.valid()&&self.form.find(".hidden-input").val()===""){$.ajax({url:self.form.attr("action"),data:formData,method:"POST",contentType:false,processData:false,beforeSend:function(){formData.append("description",self.form.find('[name="description"]').val());formData.append("subject",self.form.find('[data-type="subject"]').val());formData.append("grade",self.form.find('[data-type="grade"]').val());formData.append("session_type",self.form.find(".instant-help-custom-radio-btn").find("input:checked").val());formData.append("preferred-date",self.form.find("#preferred-date").val());formData.append("preferred-time",self.form.find("#preferred-time").val());formData.append("preferred-duration",self.form.find("#preferred-duration").val());self.form.find(".submit_form").addClass("skl-btn-loading")},success:function(response){self.form.find(".submit_form").removeClass("skl-btn-loading");if(response.status===true){self.container.find("#instant-help-step-1").animateCss("fadeOutUp",function(){self.container.find("#instant-help-step-1").hide();if(!response.has_user){self.showInstantHelpStep_2()}else if(self.sessionType==="custom"&&!response.hasBillingDetails){self.showInstantHelpStep_3()}else{self.container.find(".help-wrapper").append('<div class="text-center thisone tutors-count-info"><div class="skl-fading-circle center-block"><div class="sk-circle1 sk-circle"></div> <div class="sk-circle2 sk-circle"></div><div class="sk-circle3 sk-circle"></div><div class="sk-circle4 sk-circle"></div> <div class="sk-circle5 sk-circle"></div><div class="sk-circle6 sk-circle"></div> <div class="sk-circle7 sk-circle"></div><div class="sk-circle8 sk-circle"></div><div class="sk-circle9 sk-circle"></div> <div class="sk-circle10 sk-circle"></div><div class="sk-circle11 sk-circle"></div><div class="sk-circle12 sk-circle"></div></div>');self.container.find(".help-wrapper").append('<h2 class="custom-info-text text-center">Give us a couple of minutes while we’re sending your request.</h2>');$.when(goToInstantHelp()).done(function(response){if(response.status){if(response.sessionId){self.container.find(".custom-info-text").remove();self.container.find(".thisone.tutors-count-info").remove();self.container.find(".help-wrapper").sklValidationResults({status:"success",successMsg:"Sent! Waiting to hear back from a tutor.",persistMessages:false,shouldSlideContainer:true});self.container.find(".help-wrapper").on("skl.validation_results_hidden",function(){if(response.role==="student"){window.location.href=Routing.generate("skooli_student_dashboard_schedule")}else{window.location.href=Routing.generate("skooli_parent_dashboard_schedule")}})}else if(response.instantHelpId){window.location.href=Routing.generate("instantHelp",{instantHelpId:response.instantHelpId,noTutorsFound:response.notutors===false?"false":"true"})}}else{$.fn.billingResponseHandler(response,function(){self.container.find(".custom-info-text").remove();self.container.find(".thisone.tutors-count-info").remove();self.container.animateCss("fadeOutUp",function(){resetInstantHelp(self.container)})})}}).fail(function(err){console.log(err)})}})}else{noty({timeout:4e3,text:response.errors,type:"error",layout:"topCenter"});self.container.find(".custom-info-text").remove();self.container.find(".thisone.tutors-count-info").remove();self.container.animateCss("fadeOutUp",function(){resetInstantHelp(self.container)})}},error:function(error){self.form.find(".submit_form").removeClass("skl-btn-loading");console.log(error)}})}})},showInstantHelpStep_2:function(){var self=this;self.container.find("#instant-help-step-2").animateCss("fadeInDown");self.container.find("#instant-help-step-2").show();self.form=self.container.find('form[name="instant-help-step-2"]');$.get(Routing.generate("skooli_instant_help_list_tutors"),function(response){if(response.status){self.container.find("#found-tutors").html(response.html);self.container.find("#found-tutors").animateCss("zoomIn")}});var $userTypes=self.form.find(".instant-help-custom-radio-btn");$userTypes.find(".radio").on("click",function(){$userTypes.find("input:checked").prop("checked",false);$(this).find("input").prop("checked",true);$(this).find("input").trigger("change");self.userType=$(this).find("input").val()});$.validator.addMethod("checkUserEmail",function(value,element){var re=/^(([^<>()[\]\\.,;:\s@\"]+(\.[^<>()[\]\\.,;:\s@\"]+)*)|(\".+\"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/;var reg="+";var newVal=value.split("@");return this.optional(element)||re.test(value)&&newVal[0].indexOf(reg)<0},"Please enter a valid email address.");$.validator.addMethod("checkUserPassword",function(value,element,regexp){var re=/^(?=.*[A-Za-z])(?=.*\d)[A-Za-z\d]{6,}$/;return this.optional(element)||re.test(value)},"Use only numbers and letters, at least 6 characters.");$.validator.addMethod("checkUserFullName",function(value,element,regexp){var re=new RegExp(regexp);var theValue=value.split(" ");var lastName=theValue[theValue.length-1];if($.trim(lastName).length===0||$.trim(theValue[0]).length===0||theValue.length===1){$.validator.messages.checkUserFullName="Please enter your first & last name.";return false}$.validator.messages.checkUserFullName="Only Characters are allowed.";return this.optional(element)||re.test(value)},"");self.form.validate({ignore:":hidden:not(.selectized)",focusInvalid:false,onfocusout:function(element){if($(element).valid()){if($(element).parent().hasClass("selectize-input")){$(element).parent().parent().next("label.error").remove()}}},errorPlacement:function(error,element){error.appendTo(element.parent().after())},highlight:function(element,errorClass){$(element).addClass("isnotvalid");$(element).siblings(".selectize-control").find(".selectize-input").addClass("isnotvalid")},unhighlight:function(element,errorClass){$(element).removeClass("isnotvalid");$(element).siblings(".selectize-control").find(".selectize-input").addClass("isnotvalid")},rules:{email:{required:true,checkUserEmail:true},firstname_lastname:{required:true,checkUserFullName:"^[a-zA-Z ]+$"},password:{required:true,checkUserPassword:true,minlength:6}}});self.form.find('[name="email"]').on("change",function(){var $that=$(this);if($that.valid()){$.ajax({url:Routing.generate("check_user_email",{token:$that.val()}),method:"POST",success:function(res){if(res.status===false){self.form.find(".submit_form").attr("disabled",true);self.form.sklValidationResults({status:"error",errorMessages:[res.message],persistMessages:false,shouldSlideContainer:false,persistenceTimeout:5e3})}else{self.form.find(".submit_form").attr("disabled",false);if(self.form.find(".status-update").length){self.form.find(".status-update").remove()}}},error:function(response){self.form.sklValidationResults({status:"error",errorMessages:["Something went wrong!"],persistMessages:false,shouldSlideContainer:false,persistenceTimeout:5e3})}})}});self.form.find(".submit_form").off().on("click",function(){self.form.submit()});self.form.off("submit").on("submit",function(e){e.preventDefault();if(self.form.valid()&&self.form.find(".hidden-input").val()===""){$.ajax({url:self.form.attr("action"),type:"POST",data:self.form.serializeArray(),beforeSend:function(){self.form.find(".submit_form").addClass("skl-btn-loading")},success:function(response){if(response.status===true){if(self.sessionType==="custom"&&self.userType==="student"){self.container.find("#instant-help-step-2").hide();self.showInstantHelpStep_3()}else if(self.userType==="parent"){self.container.find("#instant-help-step-2").hide();self.showInstantHelpStep_3()}else{$.when(goToInstantHelp()).done(function(response){if(response.status){if(response.sessionId){if(response.role==="student"){window.location.href=Routing.generate("skooli_student_dashboard_schedule")}else{window.location.href=Routing.generate("skooli_parent_dashboard_schedule")}}else if(response.instantHelpId){window.location.href=Routing.generate("instantHelp",{instantHelpId:response.instantHelpId,noTutorsFound:response.notutors===false?"false":"true"})}}}).fail(function(err){if(self.userType==="student"){window.location.href=Routing.generate("skooli_student_dashboard_schedule")}else{window.location.href=Routing.generate("skooli_parent_dashboard_schedule")}console.log(err)})}}else{self.form.find(".submit_form").addClass("skl-btn-loading")}},error:function(error){console.log(error);self.form.find(".submit_form").removeClass("skl-btn-loading")}})}});self.form.find(".login_text, .login_form").off().on("click",function(){var $signInWrapper=self.container.find("#sign-in-form");self.form.fadeOut("fast",function(){$signInWrapper.addClass("animated fadeInDown").show()});if($signInWrapper.find("form").length){return false}$.ajax({url:Routing.generate("skooli_login"),method:"POST",data:{instantHelp:true},success:function(response){$signInWrapper.html(response);var $loginOverlayForm=$signInWrapper.find("form");$loginOverlayForm.off("submit").on("submit",function(e){e.preventDefault();if($loginOverlayForm.valid()&&$loginOverlayForm.find(".hidden-input").val()===""){$.ajax({url:$loginOverlayForm.attr("action"),method:"POST",data:$loginOverlayForm.serializeArray(),beforeSend:function(){$signInWrapper.find("a.submit-button").addClass("skl-btn-loading")},success:function(response){if(response.status===true){$signInWrapper.sklValidationResults({status:"success",successMsg:response.message[0],persistMessages:false,shouldSlideContainer:false,persistenceTimeout:5e3});if(self.cb){cb(true,"successful-login")}setTimeout(function(){window.location.reload(true)},1e3)}else{$signInWrapper.find("a.submit-button").removeClass("skl-btn-loading");$signInWrapper.sklValidationResults({status:"error",errorMessages:["Maybe your password is incorrect!!"],persistMessages:false,shouldSlideContainer:false,persistenceTimeout:5e3})}}})}});$loginOverlayForm.validate({rules:{_username:{required:true,email:true},_password:{required:true}},errorPlacement:function(error,element){error.appendTo(element.parent().after())},highlight:function(element,errorClass){$(element).addClass("isnotvalid")},unhighlight:function(element,errorClass){$(element).removeClass("isnotvalid")}});$signInWrapper.find("a.submit-button").off().on("click",function(){$loginOverlayForm.submit()});$signInWrapper.find(".return-back").off().on("click",function(){$signInWrapper.fadeOut("fast",function(){self.form.fadeIn()})})}})});self.form.find('[name="timezone"]').val(typeof jstz==="undefined"?"UTC":jstz.determine().name())},showInstantHelpStep_3:function(){$.fn.loadStripe();this.getCreditCardForm()},getCreditCardForm:function(){var self=this;$.ajax({url:Routing.generate("add_new_credit_card"),type:"POST",beforeSend:function(){self.container.find("#instant-help-step-3").show();self.container.find(".cc-content-wrapper").show();self.container.find(".cc-content-wrapper").html('<img class="loading-img center-block img-responsive" style="padding:150px 0; width:100px; " src="/bundles/skoolicore/images/skooli-loading-animated-new.gif" />')},success:function(response){if($.fn.checkAjaxResponse(response)===false){self.container.find("#close-instant-help").trigger("click");return}self.container.find(".cc-content-wrapper").html(response);self.container.find('[name="checkout"]').animateCss("fadeInDown");self.container.find('[name="checkout"]').css("display","block");self.loadComponentsJs();if(self.userType==="parent"){self.container.find(".spc-code").remove()}},error:function(error){self.container.find(".cc-content-wrapper").sklValidationResults({status:"error",errorMessages:[error],persistMessages:false,shouldSlideContainer:false,persistenceTimeout:5e3})}})},loadComponentsJs:function(){var self=this;self.form=self.container.find('form[name="checkout"]');$.fn.dashboardRating();$.fn.initTooltip();this.preselectProduct();this.coupon_spc_Handler();this.countryHandler();this.handleProducts();this.formValidation();this.handleFormSubmit();this.handleParentForm();showTestimonial(self.form);this.autoRenewCheckBox();self.form.find(".cc-show-plans").on("click",function(){self.form.find("#skooli-products").find('.skl-product-wrapper:not( [data-prd="payg"] )').fadeToggle("slow")});self.form.find(".save-button").find('a[name="save"]').on("click",function(){self.form.submit()})},preselectProduct:function(){var self=this;var $skooliPrd=this.form.find("#skooli-products");if($skooliPrd.length){this.PAYASGOID=$skooliPrd.find('.product[data-product-min="0"]').data("product-id")}var plan=this.PAYASGOID;if(localStorage.getItem("savePlanProductId")!==null){var savedData=JSON.parse(localStorage.getItem("savePlanProductId"));plan=savedData.planId;if(plan!==this.PAYASGOID){$skooliPrd.find('.skl-product-wrapper:not( [data-prd="payg"] )').fadeIn("slow",function(){self.form.find(".cc-hide-on-plan").fadeOut("fast")})}}if(plan===this.PAYASGOID){this.form.find(".spc-code").find("p.title").attr("disabled",true);this.form.find(".spc-code").parent().find(".has-spc").slideUp("fast");this.form.find(".spc-code").find("input").val("");this.form.find(".spc-code").find("i.fa").removeClass("fa-check fa-times");this.form.find(".spc-code").find("p.success, p.warning").remove()}$skooliPrd.find("#checkout_product_"+plan).attr("checked",true);$skooliPrd.find('.product[data-product-id="'+plan+'"]').parent().find(".circle").addClass("selected");var dataCouponObject={couponValue:$skooliPrd.find("#coupon_input").val()};localStorage.setItem("coupon",JSON.stringify(dataCouponObject));this.creditCardInfo()},handleProducts:function(){var self=this;var $skooliPrd=this.form.find("#skooli-products");var $cardContainer=this.form.find("#cc-credit-card-content");var $products=$skooliPrd.find(".skl-product-wrapper");var $realProducts=$skooliPrd.find("#real-products");var productCookie=$.cookie("product");if(productCookie){$skooliPrd.find("#checkout_product_"+productCookie).prop("checked",true)}if(localStorage.getItem("savePlanProductId")!==null){var savedData=JSON.parse(localStorage.getItem("savePlanProductId"));setTimeout(function(){var $selectedProduct=$skooliPrd.find('.product[data-product-id="'+savedData.planId+'"]');$selectedProduct.trigger("click")},500)}$products.off().on("click",function(){var $that=$(this);var productId=$that.find(".product").data("product-id");var couponValue="";if($cardContainer.find("#coupon_input").val()!==""){couponValue=$cardContainer.find("#coupon_input").val()}else if(localStorage.getItem("coupon")!==null){var savedData=JSON.parse(localStorage.getItem("coupon"));couponValue=savedData.couponValue}var dataCouponObject={couponValue:couponValue};localStorage.setItem("coupon",JSON.stringify(dataCouponObject));$skooliPrd.find(".circle").removeClass("selected");$that.find(".circle").addClass("selected");var dataObject={planId:productId};localStorage.setItem("savePlanProductId",JSON.stringify(dataObject));$realProducts.find("input").removeAttr("checked");$realProducts.find("#checkout_product_"+productId).prop("checked",true);if(self.couponValid!==null){self.couponValid.abort();$cardContainer.find(".coupon").find("i.fa").removeClass("fa-check fa-times");$cardContainer.find(".coupon").find("p").remove()}if(self.spcValid!==null){self.spcValid.abort();$cardContainer.find(".spc-code").find("i.fa").removeClass("fa-check fa-times");$cardContainer.find(".spc-code").find("p.success, p.warning").remove()}if(productId===self.PAYASGOID){$cardContainer.find(".spc-code").find("p.title").attr("disabled",true);$cardContainer.find(".spc-code").find("input").val("");$cardContainer.find(".spc-code").find("i.fa").removeClass("fa-check fa-times");$cardContainer.find(".spc-code").find("p.success, p.warning").remove();$cardContainer.find(".spc-code").parent().find(".has-spc").slideUp("fast");$cardContainer.find(".custom-checkbox").hide();if($cardContainer.find("#coupon_input").val().trim().length>0){$cardContainer.find(".coupon-code").find("p.title").attr("disabled",false);$cardContainer.find(".coupon-code").parent().find(".coupon").slideDown("fast")}$cardContainer.find(".coupon-code").find("i.fa").removeClass("fa-check fa-times");$cardContainer.find(".coupon-code").find("p.success, p.warning").remove()}else{$cardContainer.find("#coupon_input").val(couponValue);$cardContainer.find(".spc-code").find("p.title").attr("disabled",false);$cardContainer.find(".spc-code").find("input").val("");$cardContainer.find(".spc-code").find("i.fa").removeClass("fa-check fa-times");$cardContainer.find(".spc-code").find("p.success, p.warning").remove();$cardContainer.find(".spc-code").parent().find(".has-spc").slideUp("fast");if($.trim($cardContainer.find("#coupon_input").val()).length>0){$cardContainer.find(".coupon-code").find("p.title").attr("disabled",false);$cardContainer.find(".coupon-code").parent().find(".coupon").slideDown("fast")}$cardContainer.find(".coupon-code").find("i.fa").removeClass("fa-check fa-times");$cardContainer.find(".coupon-code").find("p.success, p.warning").remove();self.form.find(".cc-hide-on-plan").fadeOut("fast");$cardContainer.find(".custom-checkbox").show()}$cardContainer.find("#coupon_input").trigger("focusout");var spcValue=$cardContainer.find("#spc_card").is(":visible")?$cardContainer.find("#spc_card").val():"";var couponVal=$cardContainer.find("#coupon_input").is(":visible")?$cardContainer.find("#coupon_input").val():"";self.creditCardInfo(couponVal,spcValue,productId)})},coupon_spc_Handler:function(){var self=this;var $ccContent=self.form.find("#cc-credit-card-content");var $couponCode=$ccContent.find(".coupon-code");var $spcCode=$ccContent.find(".spc-code");if($couponCode.length){$couponCode.find("p.title").off().on("click",function(){if($(this).parent().find(".coupon").is(":visible")){$(this).parent().find(".coupon").slideUp("fast");if(!self.form.find("#checkout_product_"+self.PAYASGOID).prop("checked")){$spcCode.find("p.title").attr("disabled",false)}$spcCode.find("input").val("");$spcCode.find("i.fa").removeClass("fa-check fa-times");$spcCode.find("p.success, p.warning").remove()}else{$spcCode.find("p.title").attr("disabled",true);$spcCode.parent().find(".has-spc").slideUp("fast");$(this).parent().find(".coupon").slideDown("fast");if(localStorage.getItem("coupon")!==null&&JSON.parse(localStorage.getItem("coupon")).couponValue!==""&&!self.form.find("#checkout_product_"+self.PAYASGOID).prop("checked")){$spcCode.find("input").removeAttr("placeholder");$spcCode.find("input").val(JSON.parse(localStorage.getItem("coupon")).couponValue);setTimeout(function(){$couponCode.find("input").trigger("focusout")},200)}}})}if($spcCode.length){$spcCode.find("p.title").off().on("click",function(){if($(this).parent().find(".has-spc").is(":visible")){$(this).parent().find(".has-spc").slideUp("fast");$couponCode.find("p.title").attr("disabled",false);$couponCode.find("input").val("");$couponCode.find("i.fa").removeClass("fa-check fa-times");$couponCode.find("p.success, p.warning").remove()}else{$couponCode.find("p.title").attr("disabled",true);$couponCode.parent().find(".coupon").slideUp("fast");$(this).parent().find(".has-spc").slideDown("fast")}})}$couponCode.find("#coupon_input").on("focusout",function(){var $coupon=$couponCode.find(".coupon");var couponText=$couponCode.find("#coupon_input").val();var selectedPlan=self.form.find("#checkout_product").find(":checked").val();if(couponText.length>0){if(self.couponValid!==null){self.couponValid.abort()}var icon='<i class="fa form-control-feedback"></i>';self.couponValid=$.ajax({url:Routing.generate("check_coupon_product",{data:couponText,product:selectedPlan}),method:"POST",success:function(res){if(!$coupon.find("i.form-control-feedback").length){$coupon.append(icon)}if(res.status===true){$coupon.find("i.fa").addClass("fa-check").removeClass("fa-times");$coupon.find("p").remove();$coupon.append('<p class="success">'+res.msg+"</p>");self.creditCardInfo()}else{$coupon.find("i.fa").addClass("fa-times").removeClass("fa-check");$coupon.find("p").remove();$coupon.append('<p class="warning">'+res.msg+"</p>");$coupon.find("i.fa-times").on("click",function(){$couponCode.find("#coupon_input").val("");$coupon.find("i.form-control-feedback").remove();$coupon.find("p").remove()})}},error:function(response){console.log("something went wrong")}})}else{$coupon.find("i.fa").removeClass("fa-check fa-times");$coupon.find("p").remove()}});$spcCode.find("#spc_card").on("focusout",function(){var $spc=$spcCode.find(".spc");var spcVal=$spcCode.find("#spc_card").val();if(spcVal.length>0&&$spcCode.find("#spc_card").valid()){if(self.spcValid!==null){self.spcValid.abort()}var icon='<i class="fa form-control-feedback"></i>';self.spcValid=$.ajax({url:Routing.generate("student_card_check",{data:spcVal}),method:"POST",success:function(res){if(!$spc.find("i.form-control-feedback").length){$spc.append(icon)}if(res.status===true){$spc.find("i.fa").addClass("fa-check").removeClass("fa-times");$spc.find("p").remove();$spc.append('<p class="success">'+res.msg+"</p>");$couponCode.find("#coupon_input").val("");self.creditCardInfo()}else{$spc.find("i.fa").addClass("fa-times").removeClass("fa-check");$spc.find("p").remove();$spc.append('<p class="warning">'+res.msg+"</p>");$spc.find("i.fa-times").on("click",function(){$spcCode.find("#spc_card").val("");$spc.find("i.form-control-feedback").remove();$spc.find("p").remove()})}},error:function(response){console.log("something went wrong")}})}else{$spc.find("i.fa").removeClass("fa-check fa-times");$spc.find("p").remove()}})},countryHandler:function(){var self=this;var $country=self.form.find("#checkout_billingCountry");var $zone=self.form.find("#checkout_billingZone");if($country.length){countryUpdateFollowUp($country,$zone,self)}$country.change(function(){countryUpdateFollowUp($country,$zone,self);$(this).parent().find(".selectize-input.isnotvalid").removeClass("isnotvalid");return false});$country.selectize({placeholder:"Country",onItemAdd:function(value,$item){this.close();this.blur();setTimeout(function(){if(!self.form.find("#checkout_product_"+self.PAYASGOID).prop("checked")){if($item.text()==="Canada"){self.form.find(".has-spc").show()}else{self.form.find(".has-spc").hide()}}},100)}});$zone.selectize({placeholder:"Province"})},creditCardInfo:function(){var $wrapper=this.form.find("#cc-credit-card-content");var productId=this.form.find("#checkout_product").find('input[type="radio"]:checked').val();var countryId=$wrapper.find("#checkout_billingCountry").val();var zoneId=$wrapper.find("#checkout_billingZone").val();var couponValue=$wrapper.find("#coupon_input").is(":visible")?$wrapper.find("#coupon_input").val():"";var spcValue=$wrapper.find("#spc_card").is(":visible")?$wrapper.find("#spc_card").val():"";$.ajax({url:Routing.generate("get_product_tax_total"),data:{coupon:couponValue,spc:spcValue,product:productId,countryId:countryId,zoneId:zoneId},beforeSend:function(){$wrapper.find(".credit-card-info-auto-update").html('<div class="skl-btn-loading"></div>')},success:function(response){var text="";if(countryId===38){text+='<div class="subtotal"> Subtotal: $'+parseFloat(response.subtotal,10).toFixed(2)+"</div>";text+='<div class="hst"> HST: $'+parseFloat(response.tax,10).toFixed(2)+"</div>";text+='<div class="total"> Total: '+response.currency+parseFloat(response.total,10).toFixed(2)+"</div>";text+='<div><i class="fa fa-asterisk" aria-hidden="true" style="font-size: 9px; position: relative; top: -2px;"></i> All charges are in CAD</div>'}else{text+='<div class="total"> Total: $'+parseFloat(response.total,10).toFixed(2)+"</div>"}$wrapper.find(".credit-card-info-auto-update").html(text)},error:function(response){console.log(response)}})},formValidation:function(){var self=this;$.validator.addMethod("digitsOnlyRegex",function(value,element,regexp){var re=new RegExp(regexp);return this.optional(element)||re.test(value)},"Please enter only digits.");self.form.validate({ignore:":hidden:not(.selectized)",focusInvalid:false,invalidHandler:function(e,validator){var invalidElements=[];for(var i=0;i<validator.errorList.length;i++){var element=$("#"+validator.errorList[i].element.id).parent().find("label:not(.error)").text();var elementMsg=validator.errorList[i].message;if($.inArray(element+": "+elementMsg,invalidElements)===-1){invalidElements.push(element+": "+elementMsg)}}self.form.find("#cc-credit-card-content").sklValidationResults({status:"error",errorMessages:invalidElements,persistMessages:false,shouldSlideContainer:false,persistenceTimeout:1e4})},onfocusout:function(element){if($(element).valid()){if($(element).parent().hasClass("selectize-input")){$(element).parent().parent().next("label.error").remove()}}},errorPlacement:function(error,element){return true},highlight:function(element,errorClass){$(element).addClass("isnotvalid");$(element).siblings(".selectize-control").find(".selectize-input").addClass("isnotvalid")},unhighlight:function(element,errorClass){$(element).removeClass("isnotvalid");$(element).siblings(".selectize-control").find(".selectize-input").addClass("isnotvalid")},rules:{"checkout[credit_card][NameOnCard]":{required:true},"checkout[credit_card][CreditCard]":{required:true,digitsOnlyRegex:"[0-9 ]+$",maxlength:19},"checkout[credit_card][Month]":{required:true,maxlength:2,digits:true},"checkout[credit_card][Year]":{required:true,maxlength:2,digits:true},"checkout[credit_card][CCV]":{required:true,digits:true,maxlength:4,minlength:3},"checkout[billingCountry]":{required:true},"checkout[billingZone]":{required:true},"checkout[spc]":{maxlength:16,number:true,required:false}},messages:{"checkout[credit_card][CreditCard]":{maxlength:"Please enter no more than 16 characters."}}});var $cc_input=self.form.find("#checkout_credit_card_CreditCard");var $cc_helper=self.form.find("#card-type-helper");var ccIsValid=false;$cc_input.validateCreditCard(function(result){if(result.card_type){var helperHtml;if(result.card_type.iconPath){helperHtml='<img src="'+result.card_type.iconPath+'" alt="'+result.card_type.name+'" />'}else{helperHtml=result.card_type.name}$cc_helper.html(helperHtml);if(result.luhn_valid&&result.length_valid){$cc_helper.addClass("valid");ccIsValid=true}else{$cc_helper.removeClass("valid");ccIsValid=false}}else{$cc_helper.html("");ccIsValid=false}})},handleFormSubmit:function(){var self=this;self.form.on("submit",function(e){e.preventDefault();if(self.form.valid()){var $cardNumber=self.form.find("#checkout_credit_card_CreditCard");var verifyCard="";$cardNumber.validateCreditCard(function(data){verifyCard=data});if(verifyCard.length_valid===false||verifyCard.luhn_valid===false){self.form.find("#cc-credit-card-content").sklValidationResults({status:"error",errorMessages:["Please provide a valid Credit Card"],persistMessages:true,persistenceTimeout:4500});if(self.form.find(".status-update").length){setTimeout(function(){self.form.find(".status-update").fadeOut("fast",function(){self.form.find(".status-update").remove()})},15e3)}self.form.find("input:visible").prop("disabled",false);return false}else{self.form.find('[name="save"]').addClass("skl-btn-loading");stripeFormSubmit(e)}}})},handleParentForm:function(){var self=this;var items=[self.form.find(".products-column"),self.form.find(".cc-column"),self.form.find(".testimonials-row")];self.form.find(".show-parent-form").on("click",function(){$.each(items,function(index,value){if(value.length){value.fadeOut()}});self.form.find("#student-pinging-parent").fadeIn("slow",function(){var options={wrapper:self.form.find("#student-pinging-parent"),elements:items};parentForm(options)})})},autoRenewCheckBox:function(){var self=this;if(self.form.find("#checkout_autorenew").length){var isChecked=self.form.find("#checkout_autorenew").is(":checked");self.form.find('label[for="checkout_autorenew"]').wrap('<div class="btn-group" data-toggle="buttons"></div>');self.form.find('label[for="checkout_autorenew"]').addClass("btn btn-default");if(isChecked){self.form.find('label[for="checkout_autorenew"]').addClass("active")}self.form.find('label[for="checkout_autorenew"]').closest('[data-toggle="buttons"]').append("<p>"+$.trim(self.form.find('label[for="checkout_autorenew"]').text())+"</p>");self.form.find('label[for="checkout_autorenew"]').html(self.form.find('label[for="checkout_autorenew"]').closest('[data-toggle="buttons"]').find('input[type="checkbox"]')).append('<i class="fa fa-check"></i>');self.form.find(".custom-checkbox").find("p").on("click",function(){if($(this).parent().find("input").is(":checked")){$(this).parent().find("input").prop("checked",false);$(this).parent().find("label").toggleClass("active");$(this).parent().find("input").trigger("change")}else{$(this).parent().find("input").prop("checked",true);$(this).parent().find("label").toggleClass("active");$(this).parent().find("input").trigger("change")}})}}};function createSessionDates(){var end=moment().add(7,"days").format("YYYY-MM-DD");var dates=[];for(i=0;i<=7;i++){if(moment().add(i,"days").isBefore(end)||moment().add(i,"days").isSame(end)){var option={id:moment().add(i,"days").format("YYYY-MM-DD"),name:moment(moment().add(i,"days").format("YYYY-MM-DD")).calendar()};dates.push(option)}}return dates}function createTimesForDay(day){var times=[];var ranges=[];var range,mstart,mend;var ROUNDING=30*60*1e3;var currTimePlusOne=moment().add(1,"hours");var currTimeWithOffset=moment(Math.floor(currTimePlusOne/ROUNDING)*ROUNDING);var today=moment().format("YYYY-MM-DD");if(moment(today).isSame(day)){mstart=currTimeWithOffset;mend=moment().endOf("day")}else{mstart=moment("00:30:00","HH:mm:ss");mend=moment().endOf("day")}range=mstart.twix(mend);ranges.push(range);$.each(ranges,function(index,value){var iter=value.iterate(15,"minutes");while(iter.hasNext()){var mtime=iter.next();var option={id:mtime.format("HH:mm"),name:mtime.format("HH:mm A")};times.push(option)}});return times}function createDurations(){var durations=[];for(var i=15;i<=120;i+=15){var hours=Math.floor(i/60)!==0?Math.floor(i/60)+" hr ":"";var minutes=i%60!==0?i%60+" min":"";var text=hours+minutes;var duration={id:i,name:text};durations.push(duration)}return durations}function resetInstantHelp(container){container.removeClass("open");$("body").css({overflow:"auto",height:"auto"});container.find(".instant-help-go-next ").find("a.skl-btn").removeClass("skl-btn-loading");container.find("#instant-help-step-1").removeClass("animated fadeInDown fadeOutUp").hide();if(container.find("#instant-help-step-1").length){container.find("#instant-help-step-1").find("form").get(0).reset();container.find(".custom-instant-help").hide()}if(container.find("#instant-help-step-1").find(".selectized").length){container.find("#instant-help-step-1").find(".selectized").get(0).selectize.destroy()}container.find("#instant-help-step-2").removeClass("animated fadeInDown fadeOutUp").hide();container.find("#instant-help-step-2").find("#sign-in-form").removeClass("animated fadeInDown fadeOutUp");container.find("#instant-help-step-2").find("#sign-in-form").html("");if(container.find("#instant-help-step-2").length){container.find("#instant-help-step-2").find("form").get(0).reset()}container.find("#found-tutors").html(generateLoadingIcon());if(container.find("#instant-help-step-2").find("#sign-in-form").find("form").length){container.find("#instant-help-step-2").find("#sign-in-form").find("form").get(0).reset()}container.find("#instant-help-step-3").removeClass("animated fadeInDown fadeOutUp").hide(400,function(){container.find("#instant-help-step-3").find(".cc-content-wrapper").html("")});container.find(".custom-info-text").remove();container.find(".thisone.tutors-count-info").remove();if(ajaxRequests.length>0){$.each(ajaxRequests,function(id,jqXHR){jqXHR.abort()})}}function showTestimonial(container){var $testimonialWrapper=container.find("#cc-testimonials");var items=$testimonialWrapper.find(".testimonial-content").length;var randomTestimonial=Math.floor(Math.random()*items);$testimonialWrapper.find('div.testimonial-content:eq("'+randomTestimonial+'")').fadeIn("fast")}function countryUpdateFollowUp($countryInput,$zoneInput,self){var $contactNumberInput=self.form.find("#parent-phone");var val=$countryInput.val();if(!val){$zoneInput.prop("disabled",true);return}$zoneInput.prop("disabled",false);var countryURL=Routing.generate("country_ajax_call",{cid:val});$.ajax({type:"GET",url:countryURL,success:function(data){if($zoneInput.hasClass("selectized")){$zoneInput.get(0).selectize.destroy()}$zoneInput.html("");$.each(data[0],function(k,v){$zoneInput.append('<option value="'+k+'">'+v+"</option>")});$zoneInput.selectize({selectOnTab:true,placeholder:"Province",onInitialize:function(){setTimeout(function(){self.creditCardInfo()},100)},onChange:function(){setTimeout(function(){self.creditCardInfo()},100)}});$zoneInput.parent().find(".selectize-input").find("input").css({opacity:0,position:"absolute",left:-1e4});if($contactNumberInput.length){$contactNumberInput.intlTelInput("destroy");$contactNumberInput.intlTelInput();$contactNumberInput.intlTelInput("selectCountry",data[1][0])}}})}function stripeFormSubmit(e){e.preventDefault();var $form=$(e.target);var $cNumber=$form.find("#checkout_credit_card_CreditCard");var $cHolder=$form.find("#checkout_credit_card_NameOnCard");var $cExpirationMonth=$form.find("#checkout_credit_card_Month");var check_month=$cExpirationMonth.val().slice(0,2);if(check_month[0]===0){$cExpirationMonth.val(check_month[1])}var $cExpirationYear=$form.find("#checkout_credit_card_Year");var $cCVC=$form.find("#checkout_credit_card_CCV");function handleStripeReq(status,response){var $form=$("#instant-help-step-3").find('[ name="checkout" ]');if(response.error){$form.find("#cc-credit-card-content").sklValidationResults({status:"error",errorMessages:[response.error.message],persistMessages:true,persistenceTimeout:5e3});$form.find('[name="save"]').removeClass("skl-btn-loading")}else{var token='<input type="hidden" name="stripeToken" value="'+response.id+'" />';if(!$form.find('[name="stripeToken"]').length){$form.append(token)}else{$form.find('[name="stripeToken"]').val(response.id)}$form.find('input:visible:not([id="coupon_input"], [id="spc_card"], [id="checkout_autorenew"])').prop("disabled",true);$form.find("#checkout_credit_card_CreditCard").prop("disabled",true);var $cc_input=$form.find("#checkout_credit_card_CreditCard");var $cc_clone=$cc_input.clone();$cc_input.hide();$cc_input.parent().append($cc_clone);$cc_clone.val($cc_input.val().replace(/ /g,""));$cc_clone.attr("name","cc_clone");$cc_clone.prop("disabled",true);$cc_input.val($cc_input.val().replace(/ /g,""));var check_month=$form.find("#checkout_credit_card_Month").val().slice(0,2);if(check_month[0]===0){$form.find("#checkout_credit_card_Month").val(check_month[1])}$form.find('[name="save"]').addClass("skl-btn-loading");$.ajax({url:$form.attr("action"),type:"POST",data:$form.serializeArray(),success:function(response){if(response.status){$("#instant-help-step-3").find(".cc-content-wrapper").sklValidationResults({status:"success",successMsg:"Funding source was added to your account.",persistMessages:false,shouldSlideContainer:false});setTimeout(function(){if(response.userRole==="parent"){window.location.href=Routing.generate("skooli_parent_dashboard_schedule");return false}$.when(goToInstantHelp()).done(function(response){if(response.status){if(response.sessionId){if(response.role==="student"){window.location.href=Routing.generate("skooli_student_dashboard_schedule")}else{window.location.href=Routing.generate("skooli_parent_dashboard_schedule")}}else if(response.instantHelpId){window.location.href=Routing.generate("instantHelp",{instantHelpId:response.instantHelpId,noTutorsFound:response.notutors===false?"false":"true"})}}}).fail(function(err){console.log(err)})},3e3)}else{$form.find('[name="save"]').removeClass("skl-btn-loading");$cc_input.show(function(){$(this).val("");$(this).validateCreditCard()});$cc_clone.remove();$form.find("#cc-credit-card-content").sklValidationResults({status:"error",errorMessages:response.error,persistMessages:false,shouldSlideContainer:false,persistenceTimeout:2e4});$form.find("input:visible").prop("disabled",false)}}})}}function getUserAddress(){return $.get(Routing.generate("user_billing_data"))}$.when(getUserAddress()).done(function(response){var strForm="";strForm+="<form>";strForm+='<input type="text" size="20" data-stripe="number" value="'+$cNumber.val().replace(/ /g,"")+'" />';strForm+='<input type="text" size="2" data-stripe="name" value="'+$cHolder.val()+'" />';strForm+='<input type="text" size="2" data-stripe="exp_month" value="'+$cExpirationMonth.val()+'" />';strForm+='<input type="text" size="2" data-stripe="exp_year" value="'+$cExpirationYear.val()+'" />';strForm+='<input type="text" size="4" data-stripe="cvc" value="'+$cCVC.val()+'" />';strForm+='<input type="text" size="4" data-stripe="address_city" value="'+$form.find(".requiredProvince").find("div.item").text()+'" />';strForm+='<input type="text" size="4" data-stripe="address_country" value="'+response.address_country+'" />';strForm+='<input type="text" size="4" data-stripe="address_line1" value="'+response.address_line1+'" />';strForm+='<input type="text" size="4" data-stripe="address_state" value="'+$form.find(".requiredCountry").find("div.item").text()+'" />';strForm+='<input type="text" size="4" data-stripe="address_zip" value="'+response.address_zip+'" />';strForm+="</form>";Stripe.card.createToken($(strForm),handleStripeReq)});return false}function parentForm(options){var $parentWrapper=options.wrapper;if(!$parentWrapper.find("#parent-phone").parent().hasClass(".intl-tel-input")){$parentWrapper.find("#parent-phone").intlTelInput({defaultCountry:"ca",dialCodeDelimiter:" "})}var $actions=$parentWrapper.find(".actions");function goBack(){$parentWrapper.fadeOut("fast",function(){$.each(options.elements,function(index,value){if(value.length){value.fadeIn()}})})}$actions.find("a.go-back").off().on("click",function(){goBack()});$actions.find("button").off().on("click",function(e){e.preventDefault();var $that=$(this);var $name=$parentWrapper.find("#parent-name");var $email=$parentWrapper.find("#parent-email");var $phone=$parentWrapper.find("#parent-phone");var $hiddenInput=$parentWrapper.find(".hidden-input");$name.rules("add",{required:true});$email.rules("add",{required:function(element){return $name.val().trim()!==""&&$phone.val().trim()===""},email:true});$phone.rules("add",{required:function(element){return $name.val().trim()!==""&&$email.val().trim()===""},minlength:6});$email.on("change",function(){if($email.val().trim().length===0){setTimeout(function(){$email.removeClass("isnotvalid")},500)}else{setTimeout(function(){$phone.removeClass("isnotvalid")},500)}});$phone.on("change",function(){if($phone.val().trim().length===0){setTimeout(function(){$phone.removeClass("isnotvalid")},500)}else{setTimeout(function(){$email.removeClass("isnotvalid")},500)}});if(!$name.valid()||!$email.valid()||!$phone.valid()||$hiddenInput.val().length){return false}var name=$name.val();var email=$email.val();var phone=$phone.val();var data={parentName:name,parentEmail:email,parentPhone:phone};$.ajax({url:Routing.generate("pinging_parent"),data:data,type:"POST",beforeSend:function(){$that.addClass("skl-btn-loading")},success:function(response){$that.removeClass("skl-btn-loading");goBack()},error:function(response){goBack();console.log(response)}})})}function generateLoadingIcon(){var loading='<div class="skl-fading-circle">';for(var i=1;i<=12;i++){loading+='<div class="sk-circle'+i+' sk-circle"></div>'}loading+="</div>";return loading}function goToInstantHelp(){return $.get(Routing.generate("instantHelpSession"))}function initInstantHelp(){var instantHelp=new InstantHelp(options);instantHelp.showInstantHelp()}initInstantHelp()}});